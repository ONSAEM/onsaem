<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onsaem.web.shop.mapper.CartMapper">

	<!-- 상품목록 장바구니 클릭시 장바구니에 담김 -->
	<insert id="cartAdd" parameterType="CartVO">
		INSERT INTO CARTS
		(CART_ID,PRODUCT_ID,CART_AMOUNT,
		CART_OPTION,CART_PRICE,MEMBER_ID)
		VALUES
		('CT'||TO_CHAR(CT_SEQ.NEXTVAL),
		#{productId},#{cartAmount},#{cartOption},
		(SELECT PRICE
		FROM PRODUCTS
		WHERE PRODUCT_ID=#{productId}) ,#{memberId})
	</insert>
	<!-- 장바구니 리스트 -->
	<select id="cartList" resultType="CartVO">
		SELECT * FROM CARTS
		WHERE
		MEMBER_ID=#{memberId}
	</select>

	<!-- 나의 장바구니 리스트 -->
	<select id="myCartList"
		resultType="com.onsaem.web.shop.service.CartVO">
		select p.product_name, p.price, c.cart_amount,
		c.cart_option
		from products p join carts c
		on p.product_id = c.product_id
		where c.member_id = #{memberId}
		group by p.product_name, p.price, c.cart_amount, c.cart_option

	</select>
</mapper>