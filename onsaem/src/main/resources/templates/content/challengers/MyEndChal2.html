<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
   xmlns:th="http://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
   layout:decorate="~{layout/layout}">
<!-- sss -->
<!-- index.html 고유 CSS 추가 -->
<head>
<style type="text/css">
	 .modal-custom{display:none; position:fixed; z-index:1; padding-top:100px; left:0; top:0; width:100%; height:100%; overflow:auto; background-color:rgb(0,0,0); background-color:rgba(0,0,0,0.4); /* Black w/ opacity */
	}
	 .modal-content{position:relative; background-color:#fefefe; margin:auto; padding:0; border:1px solid #888; width:80%; box-shadow:0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19); -webkit-animation-name:animatetop; -webkit-animation-duration:0.4s; animation-name:animatetop; animation-duration:0.4s}
	 @-webkit-keyframes animatetop{
	     from{top:-300px; opacity:0}
	     to{top:0; opacity:1}
	}
	@keyframes animatetop{
	    from{top:-300px; opacity:0}
	    to{top:0; opacity:1}
	}
	.close-modal{color:white; float:right; font-size:28px; font-weight:bold; }
	.close-modal:hover,.close-modal:focus{color:#000; text-decoration:none; cursor:pointer; }
	.modal-header{padding:2px 16px; margin: 0, auto;}
	.modal-body{padding:2px 16px; }
	.modal-footer{padding:2px 16px; }
	button {
   all: unset;
   background-color: pink;
   color: white;
   padding: 5px 25px;
   border-radius: 10px;
   cursor: pointer;
   margin : 1px;
}
	

</style>
</head>

<th:block layout:fragment="css">
   <!--    <link rel="stylesheet" th:href="@{/css/page/home.css}" >-->
   <link rel="stylesheet" th:href="@{/challengers/css/mycss.css}">
   <link rel="stylesheet" th:href="@{/shoptemplate/css/style.css}"
      type="text/css">
   	<link rel="stylesheet"
		th:href="@{/shoptemplate/css/font-awesome.min.css}" type="text/css">
	<link rel="stylesheet" th:href="@{/shoptemplate/css/elegant-icons.css}"
		type="text/css">
	<link rel="stylesheet" th:href="@{/shoptemplate/css/nice-select.css}"
		type="text/css">
	<link rel="stylesheet"
		th:href="@{/shoptemplate/css/shop/css/jquery-ui.min.css}"
		type="text/css">
	<link rel="stylesheet"
		th:href="@{/shoptemplate/css/owl.carousel.min.css}" type="text/css">
	<link rel="stylesheet" th:href="@{/shoptemplate/css/slicknav.min.css}"
		type="text/css">
	<link rel="stylesheet" th:href="@{/shoptemplate/css/style.css}"
		type="text/css">

</th:block>
<script src="/resources/vendor/bootstrap/js/bootstrap.min.js"></script>





<!-- Content -->
<div layout:fragment="content">

   <section class="breadcrumb-section set-bg"
      th:data-setbg="@{/shoptemplate/img/breadcrumb.jpg}">
      <div class="container">
         <div class="row">
            <div class="col-lg-12 text-center">
               <div class="breadcrumb__text">
                  <h2>Challengers</h2>
                  <div class="breadcrumb__option">
                     <a href="./index.html">Home</a> <a href="./index.html">Vegetables</a>
                     <span>Vegetable’s Package</span>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </section>

   <div class="app-container">


      <div class="app-content">

         <div class="app-sidebar">
            <a href="" class="app-sidebar-link active"> <svg
                  xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor"
                  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="feather feather-home">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
          <polyline points="9 22 9 12 15 12 15 22" /></svg>
            </a> <a href="" class="app-sidebar-link"> <svg
                  class="link-icon feather feather-pie-chart"
                  xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  fill="none" stroke="currentColor" stroke-linecap="round"
                  stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24">
          <defs />
          <path
                     d="M21.21 15.89A10 10 0 118 2.83M22 12A10 10 0 0012 2v10z" />
        </svg>
            </a> <a href="" class="app-sidebar-link"> <svg
                  xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor"
                  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
          <line x1="16" y1="2" x2="16" y2="6" />
          <line x1="8" y1="2" x2="8" y2="6" />
          <line x1="3" y1="10" x2="21" y2="10" /></svg>
            </a> <a href="" class="app-sidebar-link"> <svg
                  class="link-icon feather feather-pie-chart"
                  xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  fill="none" stroke="currentColor" stroke-linecap="round"
                  stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24">
          <defs />
          <circle cx="12" cy="12" r="3" />
          <path
                     d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" />
        </svg>
            </a>
         </div>
         <div class="projects-section">
            <div class="projects-section-header">
               <p>완료 챌린저스</p>
               <p class="time">December, 12</p>
            </div>
            <div class="projects-section-line">
               <div class="projects-status">
                  <div class="item-status">
                     <span class="status-number">45</span> <span class="status-type">In
                        Progress</span>
                  </div>
                  <div class="item-status">
                     <span class="status-number">24</span> <span class="status-type">Upcoming</span>
                  </div>
                  <div class="item-status">
                     <span class="status-number">62</span> <span class="status-type">Total
                        Projects</span>
                  </div>
               </div>
               <div class="view-actions">
                  <button class="view-btn list-view" title="List View">
                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="feather feather-list">
                                <line x1="8" y1="6" x2="21" y2="6" />
                                <line x1="8" y1="12" x2="21" y2="12" />
                                <line x1="8" y1="18" x2="21" y2="18" />
                                <line x1="3" y1="6" x2="3.01" y2="6" />
                                <line x1="3" y1="12" x2="3.01" y2="12" />
                                <line x1="3" y1="18" x2="3.01" y2="18" /></svg>
                  </button>
                  <button class="view-btn grid-view active" title="Grid View">
                     <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="feather feather-grid">
				              <rect x="3" y="3" width="7" height="7" />
				              <rect x="14" y="3" width="7" height="7" />
				              <rect x="14" y="14" width="7" height="7" />
				              <rect x="3" y="14" width="7" height="7" /></svg>
                  </button>
               </div>
            </div>
            <div class="project-boxes jsGridView">
               <!-- 한개 -->
               <div class="project-box-wrapper" th:each="chal:${chals}">
                  <div class="project-box" style="background-color: #fee4cb;">
                     <div class="project-box-header"></div>
                     <div class="project-box-content-header">
                        <p class="box-content-header" th:text="${chal.chalName}">Web
                           Designing</p>
                        <p class="box-content-subheader" th:text="${chal.subClass}+'전'">Prototyping</p>
                        <input type="hidden" th:name="chalId" th:value="${chal.chalId}">
                     </div>
                     <p
                        th:text="${#dates.format(chal.startDate, 'MM월 dd일')} + ' ~ ' + ${#dates.format(chal.endDate, 'MM월 dd일')}"></p>
                     <div class="project-box-footer">
                        <div class="participants">
							<button th:if="${chal.receipt} !=null" class="modal-custom-button" href="#myModal1" th:value="${chal.chalId}" name="영수증">기부영수증 ⭕</button>
							<button th:if="${chal.receipt} == null" class="modal-custom-button" href="#myModal1" th:value="${chal.chalId}" name="영수증">기부영수증 ❌</button>
							<button th:if="${chal.resultPoint} !=null" class="modal-custom-button" href="#myModal2" name="포인트">포인트 확인</button>
							<button th:if="${chal.resultPoint} ==null" class="modal-custom-button" name="포인트">포인트 미정산</button>
                        </div>
                     </div>

                  </div>

                  <!-- 모달창 -->

						<!-- Trigger/Open The Modal -->
						
						<!-- The Modal -->
						<div id="myModal1" class="modal-custom">
						
						    <!-- Modal content -->
						    <div class="modal-content">
						        <div class="modal-header">
						            <span class="close-modal">×</span>
						            <h5>기부 영수증</h5>
						        </div>
						        <div class="modal-body">
						            <p></p>
						            <img id="receipt">
						        </div>
						        <div class="modal-footer">
						        <h5>기부에 참여해 주셔서 감사합니다!</h5>
						        </div>
						    </div>
						
						</div>
						

						<!-- The Modal -->
						<div id="myModal2" class="modal-custom">
						
						    <!-- Modal content -->
						    <div class="modal-content">
						        <div class="modal-header">
						            <span class="close-modal">×</span>
						            <h2>포인트 정산 내역</h2>
						        </div>
						        <div class="modal-body">
						        	<div id="private">
							            <span><p>챌린지 명 :</p><p>이름</p></span>
							            <span><p>참가 아이디 :</p><p>이름</p></span>
							            <span><p>팀전/개인전 :</p><p>개인전</p></span>
							            <span><p>기부금 :</p><p>결과</p></span>
							            <span><p>달성률 :</p><p>결과</p></span>
							            <span><p>결과 :</p><p>결과</p></span>						            
							            <span><p>정산 포인트 :</p><p>결과</p></span>
						            </div>
						            <div id="team">
							            <span><p>챌린지 명 :</p><p>이름</p></span>
							            <span><p>참가 아이디 :</p><p>이름</p></span>
							            <span><p>팀전/개인전 :</p><p>팀전</p></span>
							            <span><p>기부금 :</p><p>결과</p></span>
							            <span><p>우리팀 달성률 :</p><p>결과</p><p>상대팀 달성률 :</p><p>결과</p></span>
							            <span><p>결과 :</p><p>결과</p></span>						            
							            <span><p>정산 포인트 :</p><p>결과</p></span>
						            </div>
						        </div>
						        <div class="modal-footer">
						            <h3>Modal Footer</h3>
						        </div>
						    </div>
						</div>
						
						
						
						
				   <!-- 끝 -->
               </div>
            </div>
         </div>
      </div>
   </div>
	
   <!-- index.html 고유 스크립트 추가 -->
   <th:block layout:fragment="script">
      <script th:src="@{/shoptemplate/js/main.js}"></script>
   </th:block>
   <script type="text/javascript">
      document.addEventListener('DOMContentLoaded', function() {
         var modeSwitch = document.querySelector('.mode-switch');

         modeSwitch.addEventListener('click', function() {
            document.documentElement.classList.toggle('dark');
            modeSwitch.classList.toggle('active');
         });

         var listView = document.querySelector('.list-view');
         var gridView = document.querySelector('.grid-view');
         var projectsList = document.querySelector('.project-boxes');

         listView.addEventListener('click', function() {
            gridView.classList.remove('active');
            listView.classList.add('active');
            projectsList.classList.remove('jsGridView');
            projectsList.classList.add('jsListView');
         });

         gridView.addEventListener('click', function() {
            gridView.classList.add('active');
            listView.classList.remove('active');
            projectsList.classList.remove('jsListView');
            projectsList.classList.add('jsGridView');
         });

         document.querySelector('.messages-btn').addEventListener(
               'click',
               function() {
                  document.querySelector('.messages-section').classList
                        .add('show');
               });

         document.querySelector('.messages-close').addEventListener(
               'click',
               function() {
                  document.querySelector('.messages-section').classList
                        .remove('show');
               });
      });
      

      //모달창 생성
		var btn = document.querySelectorAll("button.modal-custom-button");
		var modals = document.querySelectorAll('.modal-custom');
		var spans = document.getElementsByClassName("close-modal");
		
		for (var i = 0; i < btn.length; i++) {
		    btn[i].onclick = function (e) {
		        e.preventDefault();
		        modal = document.querySelector(e.target.getAttribute("href"));
		        modal.style.display = "block";
		        //console.log(e.target.name);
		        let name = e.target.name;
		        let groupId = e.target.value;
		        if(name == '영수증'){
		        	console.log("영수증");
		        	//영수증 불러오기 이미지파일,,
		        	$.ajax({
		        		url:'/mypage/seeRecepit',
		        		method : 'POST',
		        		data : {groupId, groupId},
		        		success : function(result){
		        			console.log(result);
		        			let imgsrc = result.fileRoute;
		        			$('#receipt').attr("src", '/fileView/'+imgsrc);
		        		},
		        		error : function(error){
		        			console.log(error);
		        		}
		        		
		        	})
		        }else{
		        	console.log("포인트");
		        	//포인트랑,,,참가율 계산위해,,뭔갈 불러와야한다..
		        	$.ajax({
		        		url:'/mypage/checkPoint',
		        		method : 'POST',
		        		data : {groupId, groupId},
		        		success : function(result){
		        			console.log(result);
		        		},
		        		error : function(error){
		        			console.log(error);
		        		}
		        })   
		        }// end of else
		    
		    spans[i].onclick = function () {
		        for (var index in modals) {
		            if (typeof modals[index].style !== 'undefined') modals[index].style.display = "none";
		        }
		    }
		}
		
		// When the user clicks anywhere outside of the modal, close it
		window.onclick = function (event) {
		    if (event.target.classList.contains('modal-custom')) {
		        for (var index in modals) {
		            if (typeof modals[index].style !== 'undefined') modals[index].style.display = "none";
		        }
		    }
		}

      //=----모달창관련 스크립트 끝
      
		}
   </script>
</div>
</html>