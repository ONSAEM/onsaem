<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<!-- index.html 고유 CSS 추가 -->
<th:block layout:fragment="css">
    <!--    <link rel="stylesheet" th:href="@{/css/page/home.css}" >-->
    <link rel="stylesheet" th:href="@{/shoptemplate/css/bootstrap.min.css}"
		type="text/css">
	<link rel="stylesheet"
		th:href="@{/shoptemplate/css/font-awesome.min.css}" type="text/css">
	<link rel="stylesheet" th:href="@{/shoptemplate/css/elegant-icons.css}"
		type="text/css">
	<link rel="stylesheet" th:href="@{/shoptemplate/css/nice-select.css}"
		type="text/css">
	<link rel="stylesheet"
		th:href="@{/shoptemplate/css/shop/css/jquery-ui.min.css}"
		type="text/css">
	<link rel="stylesheet"
		th:href="@{/shoptemplate/css/owl.carousel.min.css}" type="text/css">
	<link rel="stylesheet" th:href="@{/shoptemplate/css/slicknav.min.css}"
		type="text/css">
	<link rel="stylesheet" th:href="@{/shoptemplate/css/style.css}"
		type="text/css">
</th:block>
    
<!-- index.html 고유 스크립트 추가 -->
<th:block layout:fragment="script">
    <!--    <script th:src="@{/js/page/home.js}"></script>-->
	<script type="text/javascript" th:src="@{/libs/smarteditor/js/service/HuskyEZCreator.js}"></script>
</th:block>



<!-- Content -->
<div layout:fragment="content">
		<headers>

			<frame-options disabled="true"/>

		</headers>
	<h1>글 등록</h1>
	<form method="post" action="/blog/blogInsert" name="myfrm">
		<ul>
			<li>글 제목 : <input type="text" name="writeTitle"></li>
			<li>소제목 : <input type="text" name="subTitle"></li>
			<li>카테고리<select name="categoryId"> <!-- 카테고리 부분 나중에 value 수정 필요 -->
			    <option value="CT001">자연</option>
			    <option value="CT002" selected>일상</option>
			    <option value="CT003">재활용</option>
			    <option value="CT004">비밀일기</option>
				</select>
			</li>
			
			<li>공개범위<select name="publicScope"> <!-- 공개범위 부분 나중에 value 수정 필요 -->
			    <option value="public">전체공개</option>
			    <option value="partial" selected>일부공개</option>
			    <option value="private">비공개</option>
				</select>
			</li>	
		
		<li><textarea name="blogWrite" id="ir1" rows="10" cols="100"></textarea></li>
		<li><button type="button" class="btn">등록</button></li>
		</ul>
		
	</form>
	
	
	
	<!--  Naver Editor -->
	<script>
		let path = '[[${#request.contextPath}]]'; //절대경로
		console.log(path);
		var oEditors = [];
		nhn.husky.EZCreator.createInIFrame({
			oAppRef: oEditors,
			elPlaceHolder: "ir1",
			sSkinURI: "/libs/smarteditor/SmartEditor2Skin.html",
			fCreator: "createSEditor2"
		});
		
// 		작성한 내용 콘솔에 찍기
		$(".btn").on("click", function() {
			oEditors.getById["ir1"].exec("UPDATE_CONTENTS_FIELD", []);
			var value = document.getElementById("ir1").value;
			console.log('[(${#authentication.principal.memberId})]');
			// location.href 세션 아이디 값이 안 땡겨와져요...
			$.ajax({
			      url: '/blog/myblog/blogWrite/blogInsert',
			      method: 'post',
			      contentType: 'application/x-www-form-urlencoded',
			      data: $('form[name="myfrm"]').serialize(),
			      success: function (result) {
			         console.log(result);
			         alert('등록 완료');
			         location.href='/blog/myblog?userId='+'[(${#authentication.principal.memberId})]'; 
			      },
			      error: function (error) {
			         console.log(error);
			      }
			   })
		});
		
	</script>
	<!-- JS -->
		<th:block layout:fragment="script">
			<script th:src="@{/shoptemplate/js/jquery-3.3.1.min.js}"></script>
			<script th:src="@{/shoptemplate/js/bootstrap.min.js}"></script>
			<script th:src="@{/shoptemplate/js/jquery.nice-select.min.js}"></script>
			<script th:src="@{/shoptemplate/js/jquery-ui.min.js}"></script>
			<script th:src="@{/shoptemplate/js/jquery.slicknav.js}"></script>
			<script th:src="@{/shoptemplate/js/mixitup.min.js}"></script>
			<script th:src="@{/shoptemplate/js/owl.carousel.min.js}"></script>
			<script th:src="@{/shoptemplate/js/main.js}"></script>
		</th:block>
</div>
</html>