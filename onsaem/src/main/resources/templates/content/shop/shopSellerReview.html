<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="light"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/sellerLayout}">

<!-- Css  -->
<th:block layout:fragment="css">
</th:block>

<head>
<meta charset="UTF-8">
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<style type="text/css">
button {
	all: unset;
	background-color: #9dc2c0;
	color: white;
	padding: 5px 25px;
	border-radius: 10px;
	cursor: pointer;
}

.btn {
	margin-top: 60px;
}

.modal {
	display: flex;
	justify-content: center;
	align-items: center;
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
}

.modal__background {
	background-color: rgba(0, 0, 0, 0.6);
	width: 100%;
	height: 100%;
	position: absolute;
}

.modal__content {
	text-align: center;
	position: relative;
	background-color: white;
	border-radius: 10px;
	top: 0;
	padding: 10px 25px;
	width: 20%;
}

h1 {
	margin: 0;
	margin-bottom: 13px;
}

.hidden {
	display: none;
}
</style>
</head>

<body>
	<div layout:fragment="content" class="app-content" id="app">
		<div class="app-content-header">
			<h1 class="app-content-headerText">Products</h1>
			<button class="mode-switch" title="Switch Theme">
				<svg class="moon" fill="none" stroke="currentColor"
					stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
					width="24" height="24" viewBox="0 0 24 24">
					<defs></defs>
					<path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
				</svg>
			</button>
			
		</div>
		
		<div class="products-area-wrapper tableView">
			<div class="products-header">
				<div class="product-cell image">
					No.
					<button class="sort-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							viewBox="0 0 512 512">
							<path fill="currentColor"
								d="M496.1 138.3L375.7 17.9c-7.9-7.9-20.6-7.9-28.5 0L226.9 138.3c-7.9 7.9-7.9 20.6 0 28.5 7.9 7.9 20.6 7.9 28.5 0l85.7-85.7v352.8c0 11.3 9.1 20.4 20.4 20.4 11.3 0 20.4-9.1 20.4-20.4V81.1l85.7 85.7c7.9 7.9 20.6 7.9 28.5 0 7.9-7.8 7.9-20.6 0-28.5zM287.1 347.2c-7.9-7.9-20.6-7.9-28.5 0l-85.7 85.7V80.1c0-11.3-9.1-20.4-20.4-20.4-11.3 0-20.4 9.1-20.4 20.4v352.8l-85.7-85.7c-7.9-7.9-20.6-7.9-28.5 0-7.9 7.9-7.9 20.6 0 28.5l120.4 120.4c7.9 7.9 20.6 7.9 28.5 0l120.4-120.4c7.8-7.9 7.8-20.7-.1-28.5z" />
						</svg>
					</button>
				</div>
				<div class="product-cell category">
					작성일자
					<button class="sort-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							viewBox="0 0 512 512">
							<path fill="currentColor"
								d="M496.1 138.3L375.7 17.9c-7.9-7.9-20.6-7.9-28.5 0L226.9 138.3c-7.9 7.9-7.9 20.6 0 28.5 7.9 7.9 20.6 7.9 28.5 0l85.7-85.7v352.8c0 11.3 9.1 20.4 20.4 20.4 11.3 0 20.4-9.1 20.4-20.4V81.1l85.7 85.7c7.9 7.9 20.6 7.9 28.5 0 7.9-7.8 7.9-20.6 0-28.5zM287.1 347.2c-7.9-7.9-20.6-7.9-28.5 0l-85.7 85.7V80.1c0-11.3-9.1-20.4-20.4-20.4-11.3 0-20.4 9.1-20.4 20.4v352.8l-85.7-85.7c-7.9-7.9-20.6-7.9-28.5 0-7.9 7.9-7.9 20.6 0 28.5l120.4 120.4c7.9 7.9 20.6 7.9 28.5 0l120.4-120.4c7.8-7.9 7.8-20.7-.1-28.5z" />
						</svg>
					</button>
				</div>
				<div class="product-cell status-cell">
					상품명
					<button class="sort-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							viewBox="0 0 512 512">
							<path fill="currentColor"
								d="M496.1 138.3L375.7 17.9c-7.9-7.9-20.6-7.9-28.5 0L226.9 138.3c-7.9 7.9-7.9 20.6 0 28.5 7.9 7.9 20.6 7.9 28.5 0l85.7-85.7v352.8c0 11.3 9.1 20.4 20.4 20.4 11.3 0 20.4-9.1 20.4-20.4V81.1l85.7 85.7c7.9 7.9 20.6 7.9 28.5 0 7.9-7.8 7.9-20.6 0-28.5zM287.1 347.2c-7.9-7.9-20.6-7.9-28.5 0l-85.7 85.7V80.1c0-11.3-9.1-20.4-20.4-20.4-11.3 0-20.4 9.1-20.4 20.4v352.8l-85.7-85.7c-7.9-7.9-20.6-7.9-28.5 0-7.9 7.9-7.9 20.6 0 28.5l120.4 120.4c7.9 7.9 20.6 7.9 28.5 0l120.4-120.4c7.8-7.9 7.8-20.7-.1-28.5z" />
						</svg>
					</button>
				</div>
				<div class="product-cell status-cell">
					작성자ID
					<button class="sort-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							viewBox="0 0 512 512">
							<path fill="currentColor"
								d="M496.1 138.3L375.7 17.9c-7.9-7.9-20.6-7.9-28.5 0L226.9 138.3c-7.9 7.9-7.9 20.6 0 28.5 7.9 7.9 20.6 7.9 28.5 0l85.7-85.7v352.8c0 11.3 9.1 20.4 20.4 20.4 11.3 0 20.4-9.1 20.4-20.4V81.1l85.7 85.7c7.9 7.9 20.6 7.9 28.5 0 7.9-7.8 7.9-20.6 0-28.5zM287.1 347.2c-7.9-7.9-20.6-7.9-28.5 0l-85.7 85.7V80.1c0-11.3-9.1-20.4-20.4-20.4-11.3 0-20.4 9.1-20.4 20.4v352.8l-85.7-85.7c-7.9-7.9-20.6-7.9-28.5 0-7.9 7.9-7.9 20.6 0 28.5l120.4 120.4c7.9 7.9 20.6 7.9 28.5 0l120.4-120.4c7.8-7.9 7.8-20.7-.1-28.5z" />
						</svg>
					</button>
				</div>
				<div class="product-cell status-cell">
					별점
					<button class="sort-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							viewBox="0 0 512 512">
							<path fill="currentColor"
								d="M496.1 138.3L375.7 17.9c-7.9-7.9-20.6-7.9-28.5 0L226.9 138.3c-7.9 7.9-7.9 20.6 0 28.5 7.9 7.9 20.6 7.9 28.5 0l85.7-85.7v352.8c0 11.3 9.1 20.4 20.4 20.4 11.3 0 20.4-9.1 20.4-20.4V81.1l85.7 85.7c7.9 7.9 20.6 7.9 28.5 0 7.9-7.8 7.9-20.6 0-28.5zM287.1 347.2c-7.9-7.9-20.6-7.9-28.5 0l-85.7 85.7V80.1c0-11.3-9.1-20.4-20.4-20.4-11.3 0-20.4 9.1-20.4 20.4v352.8l-85.7-85.7c-7.9-7.9-20.6-7.9-28.5 0-7.9 7.9-7.9 20.6 0 28.5l120.4 120.4c7.9 7.9 20.6 7.9 28.5 0l120.4-120.4c7.8-7.9 7.8-20.7-.1-28.5z" />
						</svg>
					</button>
				</div>
				<div class="product-cell status-cell">
					리뷰내용
					<button class="sort-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							viewBox="0 0 512 512">
							<path fill="currentColor"
								d="M496.1 138.3L375.7 17.9c-7.9-7.9-20.6-7.9-28.5 0L226.9 138.3c-7.9 7.9-7.9 20.6 0 28.5 7.9 7.9 20.6 7.9 28.5 0l85.7-85.7v352.8c0 11.3 9.1 20.4 20.4 20.4 11.3 0 20.4-9.1 20.4-20.4V81.1l85.7 85.7c7.9 7.9 20.6 7.9 28.5 0 7.9-7.8 7.9-20.6 0-28.5zM287.1 347.2c-7.9-7.9-20.6-7.9-28.5 0l-85.7 85.7V80.1c0-11.3-9.1-20.4-20.4-20.4-11.3 0-20.4 9.1-20.4 20.4v352.8l-85.7-85.7c-7.9-7.9-20.6-7.9-28.5 0-7.9 7.9-7.9 20.6 0 28.5l120.4 120.4c7.9 7.9 20.6 7.9 28.5 0l120.4-120.4c7.8-7.9 7.8-20.7-.1-28.5z" />
						</svg>
					</button>
				</div>
				<div class="product-cell status-cell">

					<button class="sort-button">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
							viewBox="0 0 512 512">
							<path fill="currentColor"
								d="M496.1 138.3L375.7 17.9c-7.9-7.9-20.6-7.9-28.5 0L226.9 138.3c-7.9 7.9-7.9 20.6 0 28.5 7.9 7.9 20.6 7.9 28.5 0l85.7-85.7v352.8c0 11.3 9.1 20.4 20.4 20.4 11.3 0 20.4-9.1 20.4-20.4V81.1l85.7 85.7c7.9 7.9 20.6 7.9 28.5 0 7.9-7.8 7.9-20.6 0-28.5zM287.1 347.2c-7.9-7.9-20.6-7.9-28.5 0l-85.7 85.7V80.1c0-11.3-9.1-20.4-20.4-20.4-11.3 0-20.4 9.1-20.4 20.4v352.8l-85.7-85.7c-7.9-7.9-20.6-7.9-28.5 0-7.9 7.9-7.9 20.6 0 28.5l120.4 120.4c7.9 7.9 20.6 7.9 28.5 0l120.4-120.4c7.8-7.9 7.8-20.7-.1-28.5z" />
						</svg>
					</button>
				</div>
			</div>
			<div class="products-row" v-for="(review,index) in reviews">
				<div class="product-cell image">
					<span>{{index}}</span>
				</div>
				<div class="product-cell category">
					<span class="cell-label">Category:</span>{{review.reviewDate}}
				</div>
				<div class="product-cell sales">
					<span class="cell-label">Sales:</span>{{review.productName}}
				</div>
				<div class="product-cell price">
					<span class="cell-label">Price:</span>{{review.writerId}}
				</div>
				<div class="product-cell price">
					<span class="cell-label">Price:</span>{{review.reviewStar}}
				</div>
				<div class="product-cell price">
					<span class="cell-label">Price:</span>{{review.reviewContent}}
				</div>
				<div class="product-cell status-cell">
					<button @click="displayModal(review.reviewId)"
						class="app-content-headerButton" style="background-color: #9dc2c0">리뷰댓글달기</button>
				</div>
			</div>
		</div>


		<!-- 판매자 리뷰작성 -->
		<div class="modal hidden">
			<div class="modal__background"></div>
			<div class="modal__content" style="width: 16%;">
				<h3>리뷰댓글달기</h3>
				<div class="modalText">
					<textarea rows="10" cols="40" id="content"></textarea>
					<br>
					<button @click="submitBtn()" style="margin: 10px">댓글달기</button>
					<button @click="displayModal()">닫기</button>
				</div>
			</div>
		</div>

		<script type="text/javascript">		
			//csrf설정
			 var token = $("meta[name='_csrf']").attr("content");
			 var header = $("meta[name='_csrf_header']").attr("content");	
		
				let modalData;
				 //뷰 사용
				 const app = Vue.createApp({
				        data() {
				            return {	
				            	reviews:[]           	
				            };
				        },
				        created() {
							this.reviewList();						
				        },
				        methods: {
				        	displayModal:function (data) {
				        		modalData=data;				        		
				        		const modal = document.querySelector(".modal");								
								modal.classList.toggle("hidden");
							},
				        	//리뷰댓글 저장하기
				    		submitBtn:function () {
				    			let groupId = modalData;
				    			let reviewContent = $("#content").val();
				    			$.ajax({
				    				type : 'post',
				    				url : '/shop/sellerReviewContent',				
				    				beforeSend : function(xhr) {
				    					xhr.setRequestHeader(header, token);
				    				},
				    				data : {
				    					"groupId" : groupId,
				    					"reviewContent" : reviewContent
				    				},
				    				success : function(result) {
				    					alert("댓글 작성하였습니다.")
				    					location.reload();
				    				},
				    				error : function(error) {
				    					console.log(error)
				    				}
				    			})
				    		},
				        	
				        	//리뷰리스트가져오기
				        	reviewList:function(){
				        		let is=this;			        		
				        		$.ajax({
			        				type : 'get', 
			        				url : '/shop/sellerReviewList',	        				
			        				beforeSend : function(xhr)
			        	               {   /*데이터를 전송하기 전에 헤더에 csrf값을 설정한다*/
			        	               xhr.setRequestHeader(header, token);
			        	               },
			        				success : function(result) {			        					
			        					is.reviews=result;
			        				},
			        				error : function(error) { 
			        					console.log(error)
			        				}
			        			})     
				        		
				        	}
				        }
				        });
				 
				 app.mount("#app") 
			</script>

		<script type="text/javascript">
				document.querySelector(".jsFilter").addEventListener(
					"click",
					function () {
						document.querySelector(".filter-menu").classList
							.toggle("active");
					});

				document
					.querySelector(".grid")
					.addEventListener(
						"click",
						function () {
							document.querySelector(".list").classList
								.remove("active");
							document.querySelector(".grid").classList
								.add("active");
							document
								.querySelector(".products-area-wrapper").classList
								.add("gridView");
							document
								.querySelector(".products-area-wrapper").classList
								.remove("tableView");
						});

				document
					.querySelector(".list")
					.addEventListener(
						"click",
						function () {
							document.querySelector(".list").classList
								.add("active");
							document.querySelector(".grid").classList
								.remove("active");
							document
								.querySelector(".products-area-wrapper").classList
								.remove("gridView");
							document
								.querySelector(".products-area-wrapper").classList
								.add("tableView");
						});

				var modeSwitch = document.querySelector('.mode-switch');
				modeSwitch.addEventListener('click', function () {
					document.documentElement.classList.toggle('light');
					modeSwitch.classList.toggle('active');
				});
			</script>
		<!-- JS -->
		<th:block layout:fragment="script">
		</th:block>
	</div>

</body>

</html>