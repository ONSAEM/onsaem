<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">

<!-- Css  -->
<th:block layout:fragment="css">
	<link rel="stylesheet" th:href="@{/css/blog.css}"
		type="text/css">
</th:block>
<head>
<meta charset="UTF-8">
<style>
caption.dots {
  color: #5c5e6e;
  border:bottom;
  border-width: 0 0 8px;
  border-style: solid;
  border-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 1" width="5" height="4"><circle fill="gray" cx="1" cy="0.5" r="0.4"/></svg>') 0 0 100% repeat;
  width: 199px;
}
/* GENERAL STYLES */
.pagination ul {
	margin: auto;
	padding: 0;
	list-style: none;
}

/* ONE */
.p1 li {
	font-size: 14px;
	width: 40px;
	height: 40px;
	line-height: 40px;
	padding: 0;
	text-align: center;
	float: left;
	cursor: pointer;
}
/* ÌåîÎ°úÏö∞Î≤ÑÌäº */
.follow {
	margin-right: 10%;
	border-color: #5F9999;
	z-index: 30;
	border: 1px solid #ffffff;
	color: #ffffff;
	opacity: 0.65;
	text-align: center;
	text-decoration: none;

}
.follow:hover {
	opacity: 1;
}
</style>
</head>
<body>
	<div layout:fragment="content">
		<div class="container" x-data="{ rightSide: false, leftSide: false }">
		  <div class="main">
		    <div class="main-container">
		    <!-- ÌîÑÎ°úÌïÑ -->
		      <div class="profile">
		        <div class="profile-avatar">
		        	<img th:if="${blogInfo.fileRoute != null}"
						th:src="'/fileView/'+${blogInfo.fileRoute}"
						alt="profile-sample5" class="profile-img" />
					<img th:if="${blogInfo.fileRoute == null}"
						th:src="@{/images/defaulltProfile.png}"
						alt="profile-sample5" class="profile-img" />
		          <div class="profile-name">[[${blogInfo.nickname}]] <span style="font-size:20px">@[[${blogInfo.blogId}]]</span> <br><p>[[${blogInfo.introduction}]]</p></div>
		        	
		        </div>
		        <!-- Ìó§Îçî -->
		        <img src="/fileView/20230127/befd71a4-98a8-4042-a72a-07ff9c715e36.gif" alt="" class="profile-cover">
		        <!-- Ìó§Îçî ÎÅù -->
		        
		        <div class="profile-menu">
		          <a type="button" class="profile-menu-link follow" th:value=${subCount} th:if="${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} != ${blogInfo.blogId}"><th:block th:if="${subCount=='F'}">Íµ¨ÎèÖÌïòÍ∏∞</th:block><th:block th:unless="${subCount=='F'}">Íµ¨ÎèÖ Ï§ë</th:block></a>
		          <a type="button" class="profile-menu-link follow" th:value=${subCount} th:unless="${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} != ${blogInfo.blogId}" style="display:none;">Íµ¨ÎèÖ</a>
		          <a th:unless="${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} == ${blogInfo.blogId}"
						style="display:none"
						th:href="@{/blog/myblog/blogTask(blogId=${blogInfo.blogId})}"
						class="profile-menu-link info">Î∏îÎ°úÍ∑∏ Í¥ÄÎ¶¨ ‚öô</a> 
				  <a th:if="${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} == ${blogInfo.blogId}"
						th:href="@{/blog/myblog/blogTask(blogId=${blogInfo.blogId})}"
						class="profile-menu-link info">Î∏îÎ°úÍ∑∏ Í¥ÄÎ¶¨ ‚öô</a>
		          <!-- Í≤ÄÏÉâÎ∞î -->
		          <a><input type="text" placeholder="Search..." id="searchWord" style="width:150px;height:30px;position:relative;margin-top:17px;margin-left:671px;overflow:auto;">
						<button type="button" class="btn btn-light" id="searchBtn" style="width:40px;height:30px;position:absolute;border-radius:2px;border:1px solid gray;margin-top:17px;">
							<i class="fa-solid fa-magnifying-glass"></i>
						</button>
				  </a>
				  <!-- Í≤ÄÏÉâÎ∞î ÎÅù -->
		        </div>
		      </div>
		     <!-- ÌîÑÎ°úÌïÑ ÎÅù -->
		      <div class="timeline">
			       <div class="left-side">
					    <div class="left-side-button">
					      <svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
					      <svg stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
					  		<path d="M19 12H5M12 19l-7-7 7-7"/>
						  </svg>
					    </div>
			    
					    <!-- ÏÇ¨Ïù¥Îìú Î∞î -->
					    <div class="side-wrapper">
					    <div class="side-title" style="margin-bottom:0px;">
					    	<div class="side-menu">
					    	<a href="#"  style="display:inherit;">
					          <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" style="margin-right:2px;margin-bottom:4px;">
					            <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
					            <path d="M9 22V12h6v10" />
					          </svg>
					          Home
						    </a>
					    	
							<a th:href="@{/blog/myblog/blogWrite/blogInsert}" th:if="${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} == ${blogInfo.blogId}"
							   class="blog__btn" style="margin-left:150px;position:absolute;"><i class="fa-solid fa-pencil"></i> Í∏ÄÏûëÏÑ±</a>
							<a th:unless="${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} == ${blogInfo.blogId}" style="display:none;"></a>
							</div>
						</div>
					    	
						    
						    <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ -->
						      <div class="side-title">CATEGORY</div>
						      <div class="side-menu">
						        <ul th:each="cate:${category}">
									<li><a class="searchCate" th:value="${cate.categoryId}" style="cursor:pointer">[[${cate.categoryName}]]</a></li>
								</ul>
						      </div>
					    </div>
			    		<!-- Ïπ¥ÌÖåÍ≥†Î¶¨ ÎÅù -->
			    
			    <!-- ÏµúÏã†Í∏Ä -->
			    <div class="side-wrapper">
			    	<div class="side-title">RECENT NEWS</div>
			    	<div class="side-menu" >
			    		<a href="#" class="blog__sidebar__recent__item"
							th:each="rW:${recentWrite}">
							<div style="margin-top:15px;">
								<h6 style="font-size:16px;color: #9c9cab;">[[${#dates.format(rW.writeDate, 'MM/dd')}]] </h6>
							</div>
							<div style="margin-left:10px;">
								<h6 th:onclick="|location.href='@{/blog/myblog/blogWrite(bno=${rW.writeId})}'|" style="font-size:16px;color: #9c9cab;">
									[[${rW.writeTitle}]] <span> [[${rW.subTitle}]]</span><br /></h6> <span><i class="fa-solid fa-eye" style="font-size:16px;"></i> [[${rW.cnt}]]</span>
							</div>
						</a>	
			    	</div>
			    </div>
			    <!-- ÏµúÏã†Í∏Ä ÎÅù -->
			    
			    <!-- Íµ¨ÎèÖ Î™©Î°ù -->
			    <div class="side-wrapper">
			      <div class="side-title">SUB LIST
				      <div class="side-menu" style="float:right;">
			        	<a th:href="@{/blog/myblog/blogSubscribe(blogId=${blogInfo.blogId})}" 
						   th:if="${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} == ${blogInfo.blogId}"><i class="fa-regular fa-square-plus"></i>&nbsp;MORE</a>
						<a th:unless="${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} == ${blogInfo.blogId}" style="display:none;"></a>
					  </div>
					</div>
					<div>
						<table id="submeTable">
							<caption class="side-title dots" style="caption-side: top;text-align:center;margin-bottom:0px;">SUB ME</caption>
							<thead>
								<tr>
									<th></th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								<th:block th:each="subMe:${subMeList}">
									<tr>
										<td>
											<img th:if="${subMe.fileRoute == null}"
												th:src="@{/images/defaulltProfile.png}"
												style="height:50px;width:50px;border-radius:10px;"/>
											<img th:if="${subMe.fileRoute != null}"
												th:src="'/fileView/'+${subMe.fileRoute}"
												style="height:50px;width:50px;border-radius:10px;"/>
										</td>
										<td><a th:href="@{/blog/myblog(userId=${subMe.memberId})}" style="margin-left:5px;">[[${subMe.memberId}]]</a></td>
									</tr>
								</th:block>
							</tbody>
						</table>
						<br/>
						<table id="mySubTable">
							<caption class="side-title dots" style="caption-side: top;text-align:center;margin-bottom:0px;">MY SUB</caption>
							<thead>
								<tr>
									<th></th>
									<th></th>
								</tr>
							</thead>
							
							<tbody>
								<th:block th:each="mySub:${mySubList}" >
									<tr>
										<td>
											<img th:if="${mySub.fileRoute == null}"
												th:src="@{/images/defaulltProfile.png}"
												style="height:50px;width:50px;border-radius:10px;"/>
											<img th:if="${mySub.fileRoute != null}"
												th:src="'/fileView/'+${mySub.fileRoute}"
												style="height:50px;width:50px;border-radius:10px;"/>
										</td>
										<td><a th:href="@{/blog/myblog(userId=${mySub.groupId})}" style="margin-left:5px;">[[${mySub.groupId}]]</a></td>
									</tr>
								</th:block>
							</tbody>
						</table>
			      </div>
			    </div>
			    <!-- Íµ¨ÎèÖ Î™©Î°ù ÎÅù -->
			  </div>
		        <div class="timeline-right">
		        <!-- Î™®Î®ºÌä∏ -->
		        		<h3 style="text-align: center; margin: 0 auto;">
							MOMENT <a data-bs-toggle="modal" data-bs-target="#insertModal"
								type="button" th:if="${mmtCnt<4} and ${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} == ${blogInfo.blogId}">‚ñ∂</a> 
								<a type="button"
								th:if="${mmtCnt==4}"
								onclick="alert('üò• Ï†ÄÏû• Í∞ÄÎä•Ìïú Î™®Î®ºÌä∏ Ïö©ÎüâÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. ÏÇ≠Ï†ú ÌõÑ Îì±Î°ùÌï¥Ï£ºÏÑ∏Ïöî!')">‚úñ</a>
								<a type="button" th:unless="${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''} == ${blogInfo.blogId}" style="display:none;"></a>
						</h3>
				      <div id="card-app" class="card-container mmtpage-content">
				      	<!-- Î™®Îã¨Ï∞Ω ÎùÑÏö∞Îäî Î≤ÑÌäº -->
						<a th:each="moment : ${moments}" data-bs-toggle="modal" data-bs-target="#exampleModal" id="modalBtn"
						 th:if="${moment.publicScope}=='public' or
						  ${moment.publicScope}=='partial' and  ${subCount} =='T' or
						  ${moment.blogId} == ${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''}">
						<a style="padding: 100px;"
						 th:unless="${moment.publicScope}=='public' or
						  ${moment.publicScope}=='partial' and  ${subCount} =='T' or
						  ${moment.blogId} == ${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''}"></a>
						  
							<input type="hidden" id="mmtId" th:value="${moment.momentId}">
					      
					        <card th:data-image="@{'/fileView/'+${moment.fileRoute}}"
					            class="mmtcard inputfield" id="preview-image"
								th:style="'background: url('+@{'/fileView/'+${moment.fileRoute}}+');background-repeat:no-repeat;background-size:cover;'">
					            <h1 class="mmttitle">@[[${moment.blogId}]]</h1>
					            <p class="mmtcopy">[[${moment.momentWrite}]]</p>
					        </card>
				        </a>
				      </div>
		        <!-- Î™®Î®ºÌä∏ ÎÅù -->
		        
			        <!-- ÌéòÏù¥Ïßï Ìï¥ÏïºÌï® -->
			        <div class="col-lg-8 col-md-7">
			          <div class="row blogList">
							
					  </div>
					</div>
					 <!-- ÌéòÏù¥Ïßï Ìï¥ÏïºÌï® --> 
		        </div>
		      </div>
		    </div>
		  </div>
		</div>
				<!-- ÌÅ¥Î°† -->
				<div class="template" style="display:none">
			          <div class="album box">
			            <div class="album-content">Í∏ÄÏ†úÎ™©1
			              <div class="album-photos" onclick="scopeCheck(this)">
			              	<input type="hidden" class="thumbnail">
							<!-- Ïç∏ÎÑ§Ïùº -->
							<img id="thumbImg" class="album-photo">
			              </div>
			            </div>
			            <div class="album-actions">
			              <a href="#" class="album-action">
			                <i class="fa fa-calendar-o"></i>
			              </a>
			              <a href="#" class="album-action">
			                <i class="fa fa-comment-o"></i>
			              </a>
			              <a href="#" class="album-action">
			                <i class="fa-solid fa-eye"></i>
			              </a>
			            </div>
			          </div>
		          </div>
				<!-- ÌÅ¥Î°† ÎÅù -->


<!-- Î™®Îã¨Ï∞Ω Ï°∞Ìöå -->
		<div class="modal fade" id="exampleModal" tabindex="-1"
			aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-xl modal-dialog-scrollable">
				<div class="modal-content">

					<div class="modal-body row">
						<div class="col-md-6 modal-image sticky-top">
							<img id="modalImg"
								src="https://unsplash.it/800/1200.jpg?image=256"
								class="img-fluid sticky-top">
						</div>
						<div class="col-md-6 p-3">
							<span class="round">
								<img th:if="${blogInfo.fileRoute != null}"
										th:src="'/fileView/'+${blogInfo.fileRoute}"
										alt="profile-sample5" class="profile" width="70" style="border-radius:100px"/>
								<img th:if="${blogInfo.fileRoute == null}"
										th:src="@{/images/defaulltProfile.png}"
										alt="profile-sample5" class="profile" width="70" style="border-radius:100px"/>
								<a class="mt-3" style="font-weight: bold;font-size:20px;">ÎãâÎÑ§ÏûÑ</a>
							</span>

							<p id="nickname">Edited ¬∑ 1d</p>
							<button class="mmtbtn" style="color: red;" id="mmtDelBtn">delete</button>
							<div class="mt-2 mx-2">
								<input type="text" class="form-control"
									placeholder="type comment" id="addUrl" readonly>
							</div>

							<div class="d-flex flex-row comment-row mt-2">
								<div class="p-2"></div>
								<div class="comment-text active w-100">
									<h5 id="mmtWrite">ÎÇ¥Ïö©</h5>
								</div>
							</div>
							<p id="uploadDate"></p>
							<!-- ÌïòÌä∏ ÏãúÍ∞Ñ ÎÇ®ÏúºÎ©¥-->
							
							<!-- ÌïòÌä∏ ÎÅù -->
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- Î™®Îã¨Ï∞Ω ÎÅù -->
		
		<!-- Î™®Î®ºÌä∏ ÏûëÏÑ± -->
		<div class="modal fade" id="insertModal" tabindex="-1"
			aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-xl modal-dialog-scrollable">
				<div class="modal-content">

					<div class="modal-body row">
						<div class="col-md-6 modal-image sticky-top">
							<h3>ÏÉÅÏÑ∏ ÎÇ¥Ïö©</h3>
							<textarea id="momentWrite" cols="58" rows="20"
								placeholder="500Ïûê ÎØ∏ÎßåÏúºÎ°ú ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî"></textarea>
						</div>
						<div class="col-md-6 p-3">

							<input type="text" class="form-control"
								placeholder="Ï≤®Î∂ÄÌï† Ï£ºÏÜåÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" id="insertUrl"> <br>
							<fieldset>
								<h3>ÏóÖÎ°úÎìú Í∏∞Í∞Ñ</h3>
								<input type="date" id="date" placeholder="Select a date"
									data-datepicker-events="{date: '2020-07-12T12:00', name: 'Business Lunch Z√ºrich', type: 'holiday'}"
									required /> <br>
								<h3>Í≥µÍ∞úÎ≤îÏúÑ</h3>
								<select name="publicScope" id="scope">
									<!-- Í≥µÍ∞úÎ≤îÏúÑ Î∂ÄÎ∂Ñ ÎÇòÏ§ëÏóê value ÏàòÏ†ï ÌïÑÏöî -->
									<option value="public">Ï†ÑÏ≤¥Í≥µÍ∞ú</option>
									<option value="partial" selected>ÏùºÎ∂ÄÍ≥µÍ∞ú</option>
									<option value="private">ÎπÑÍ≥µÍ∞ú</option>
								</select>
							</fieldset>
							<div class="mt-2 mx-2"></div>

							<div class="d-flex flex-row comment-row mt-2">
								<form id="momentFrm">
									<div class="p-2">
										Ïù¥ÎØ∏ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞
										<div class="image-container">
											<img style="width: 500px;" id="preview-image2"
												src="https://dummyimage.com/500x500/ffffff/000000.png&text=preview+image">
											<input style="display: block;" type="file" name="uploadfile"
												multiple="multiple" id="input-image">
										</div>
									</div>
								</form>
							</div>
							<input type="hidden" id="getblogId" th:value="${blogInfo.blogId}">
							<button type="button" id="mmtInsertBtn">Îì±Î°ù</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- Î™®Î®ºÌä∏ ÏûëÏÑ± ÎÅù -->

	<!-- moment -->
		<script type="text/javascript">
			
			//csrfÏÑ§Ï†ï
			 var token = $("meta[name='_csrf']").attr("content");
			 var header = $("meta[name='_csrf_header']").attr("content");	
			
			// Î∏îÎ°úÍ∑∏ ÏïÑÏù¥Îîî Í∞ÄÏ†∏Ïò§Í∏∞
			let blogId = $('#getblogId').val();
// 			console.log("Î∏îÎ°úÍ∑∏ ÏïÑÏù¥Îîî Ï∞æÏïÑÏöî~!"+blogId);
			// ÏÑ∏ÏÖò ÏïÑÏù¥Îîî Í∞í
			let sessionId = "[[${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''}]]";

			// Í≤ÄÏÉâÌï† Îïå Í∞í ÎÑ£Í∏∞
			let nowData = {"writeTitle" : null, 
						   "blogId": blogId}; 
			
			// Íµ¨ÎèÖÌñàÎäîÏßÄ ÌôïÏù∏ÌïòÍ∏∞
			let subTF = $('.follow').attr('value');
			
			// ÌéòÏù¥Ïßï Ìï† Îïå Î¶¨Ïä§Ìä∏ ÌÅ¥Î°†ÌïòÍ∏∞
			let listClone = $(".template").find(".album").first();
			
			// Ï¢ãÏïÑÏöî Ï°∞Ìöå
			let likeTF = $('.blogLike').val();
			
			// Í≤ÄÏÉâÌï†Îïå Í∞í ÎÑ£Îäî Í≥≥
			function dataMake(){
				let data = {};
				if($("#searchWord").val()){
					data['writeTitle'] = $("#searchWord").val();
					data['blogId'] = blogId;
				}
				return data;
			}
			
			// Ï†úÎ™© Í≤ÄÏÉâ
			$("#searchBtn").on("click", function(){
				nowData = dataMake();
				newBlogList(1);
			})
			
			// Ïπ¥ÌÖåÍ≥†Î¶¨ Í≤ÄÏÉâ
			$(".searchCate").each(function(){
				$(this).on("click", function(){
					let categoryId = $(this).attr("value"); // valueÎäî inputÏïÑÎãàÎ©¥ attrÎ°ú Í∞ÄÏ†∏Ïò§Í∏∞!!!!!
					nowData = {"categoryId" : categoryId,
							   "blogId" : blogId};
					newBlogList(1);
				})
			})

			
// 			// moment Î™®Îã¨
			//moment Îì±Î°ùÎ≤ÑÌäºÏùÑ ÎàÑÎ•¥Î©¥, ÏûÖÎ†•Îêú Í∞íÏùÑ DBÎ°ú Î≥¥ÎÇ¥Í∏∞
			$("#mmtInsertBtn").on("click", function(){
				let data = new FormData($('#momentFrm')[0]); //ÏïÑÏù¥ÎîîÍ∞Ä momentFrmÏùÑ Í∞ÄÏ†∏Ïò®Îã§.
				
				data.append("momentWrite", $('#momentWrite').val());
				data.append("addUrl", $('#insertUrl').val());
				data.append("uploadEnd", $('#date').val());
				data.append("publicScope",$('#scope').val());  //Ïª®Ìä∏Î°§Îü¨Ïóê Í∞ÄÏ†∏Í∞à ÎÇ¥Ïö©ÏùÑ Îã¥ÎäîÎã§.
				
				console.log(data.get("uploadfile"));
				
				$.ajax({
					url : '/blog/insertMoment',
					enctype: 'multipart/form-data',
					method : 'POST',
					processData: false,
					contentType: false,
					data : data,
					beforeSend : function(xhr)
		               {   /*Îç∞Ïù¥ÌÑ∞Î•º Ï†ÑÏÜ°ÌïòÍ∏∞ Ï†ÑÏóê Ìó§ÎçîÏóê csrfÍ∞íÏùÑ ÏÑ§Ï†ïÌïúÎã§*/
		               xhr.setRequestHeader(header, token);
		               },
					dataType:'json',
					success : function(result) {
						alert('ÏÑ±Í≥µ');
						location.reload();
					},
					error : function(error) {
						console.log(error);
						alert('Ïã§Ìå®');
					}
				})
			})
			
			// moment Î™®Îã¨ ÏÉÅÏÑ∏Î≥¥Í∏∞ Î™®Î®ºÌä∏Î≤àÌò∏ Î≥¥ÎÇ¥Í∏∞
			$(".mmtpage-content").children("#modalBtn").each(function(){ 
				$(this).on("click", function(){
					console.log(this);
					let mno = $(this).children('#mmtId').val();
					console.log(mno);
	 				$.ajax({
	 					url: '/blog/getMoment',
	 					method: 'post',
	 					contentType: 'application/x-www-form-urlencoded',
	 					data: {"momentId": mno},
	 					beforeSend : function(xhr)
	 	               {   /*Îç∞Ïù¥ÌÑ∞Î•º Ï†ÑÏÜ°ÌïòÍ∏∞ Ï†ÑÏóê Ìó§ÎçîÏóê csrfÍ∞íÏùÑ ÏÑ§Ï†ïÌïúÎã§*/
	 	               xhr.setRequestHeader(header, token);
	 	               },
	 					success: function(result){
	 						$('#exampleModal').modal('show');
	 						
	 						console.log(result);
 	 						$(".mt-3").text(result.nickname);
 	 						$("#modalImg").attr("src", "/fileView/"+result.fileRoute);
 	 						$("#addUrl").attr("placeholder",result.addUrl);
 	 						$("#mmtWrite").text(result.momentWrite);
							$("#nickname").text("@"+result.blogId+" ¬∑ "+result.writeDate.substr(0,10)+" "+result.writeDate.substr(11,5));
							$("#uploadDate").text(result.uploadStart.substr(0,10)+" - "+result.uploadEnd.substr(0,10));
	 					},
	 					error: function (error){
	 						console.log(error);
	 					}
	 				})
				})
				
				
			})
			
			
			// Î™®Îã¨ ÎÅù
			
			
// 			// input fileÏóê change Ïù¥Î≤§Ìä∏ Î∂ÄÏó¨
			const inputImage = document.getElementById("input-image")
			inputImage.addEventListener("change", function(e) {
				console.log('ÌôïÏù∏');
			    readImage(e.target);
			})
			// Ïù¥ÎØ∏ÏßÄ ÎØ∏Î¶¨Î≥¥Í∏∞
			function readImage(input) {
			    // Ïù∏Ìíã ÌÉúÍ∑∏Ïóê ÌååÏùºÏù¥ ÏûàÎäî Í≤ΩÏö∞
			    if(input.files && input.files[0]) {
			        // Ïù¥ÎØ∏ÏßÄ ÌååÏùºÏù∏ÏßÄ Í≤ÄÏÇ¨ (ÏÉùÎûµ)
			        // FileReader Ïù∏Ïä§ÌÑ¥Ïä§ ÏÉùÏÑ±
			        const reader = new FileReader();
			        // Ïù¥ÎØ∏ÏßÄÍ∞Ä Î°úÎìúÍ∞Ä Îêú Í≤ΩÏö∞
			        // readerÍ∞Ä Ïù¥ÎØ∏ÏßÄ ÏùΩÎèÑÎ°ù ÌïòÍ∏∞
			        reader.readAsDataURL(input.files[0]);
			        reader.onload = e => {
			            const previewImage = document.getElementById("preview-image2");
			            console.log('ÌôïÏù∏22');
			            previewImage.src = e.target.result;
			            console.log(previewImage.src);
			        }
			        
			    }
			}
			
// 			// Íµ¨ÎèÖ
			if(subTF == 'T'){ // ÎßåÏïΩ Í∞íÏù¥ ÏûàÎã§Î©¥
				$(".follow").css({'background-color':'#2980b9','color':'white','border-color':'white'});
			}else{
				$(".follow").css({'background-color':'','color':'#2980b9','border-color':'#2980b9'});
			}
			
			
			//Íµ¨ÎèÖ Ï†ÄÏû•
			$(".follow").on("click", function(){
				let id = "[[${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''}]]";
				if(id!=""){
					if(subTF =='F'){ // Íµ¨ÎèÖÌïòÏßÄ ÏïäÏïòÎã§Î©¥~
						let th =$(this);
						$(this).css({'background-color':'#2980b9','color':'white','border-color':'white'});
						
						$.ajax({
							url: '/blog/addSub',
							method: 'post',
							contentType: 'application/x-www-form-urlencoded',
							data: {"groupId":blogId},
							beforeSend : function(xhr)
				               {   /*Îç∞Ïù¥ÌÑ∞Î•º Ï†ÑÏÜ°ÌïòÍ∏∞ Ï†ÑÏóê Ìó§ÎçîÏóê csrfÍ∞íÏùÑ ÏÑ§Ï†ïÌïúÎã§*/
				               xhr.setRequestHeader(header, token);
				               },
							success: function(result){
								console.log(result);
								alert("Íµ¨ÎèÖ ÏôÑÎ£å");
								th.text('Íµ¨ÎèÖÏ§ë');
								subTF = 'T';
							},
							error: function(error){
								console.log(error);
							}
						})
					
				}else{
				//Íµ¨ÎèÖ Ï∑®ÏÜå
		 				$(this).css({'background-color':'','color':'#2980b9','border-color':'#2980b9'});
		 				let th =$(this);
		 				$.ajax({
		 					url: '/blog/delSub',
		 					method: 'post',
		 					contentType: 'application/x-www-form-urlencoded',
							data: {"groupId":blogId, "memberId": id},
							beforeSend : function(xhr)
				               {   /*Îç∞Ïù¥ÌÑ∞Î•º Ï†ÑÏÜ°ÌïòÍ∏∞ Ï†ÑÏóê Ìó§ÎçîÏóê csrfÍ∞íÏùÑ ÏÑ§Ï†ïÌïúÎã§*/
				               xhr.setRequestHeader(header, token);
				               },
							success: function(result){
								console.log(result);
								alert("Íµ¨ÎèÖ Ï∑®ÏÜå");
								th.text('Íµ¨ÎèÖÌïòÍ∏∞');
								subTF = 'F';
							},
							error: function(error){
								console.log(error);
							}
		 				});
				}
			}else{
					alert('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§');
				}
			});
			
			
			
// 			console.log($("document").find('#mmtDelBtn'));
			$("#mmtDelBtn").each(function(){
				console.log(this);
				$(this).on("click", function(){
					let momentId = $('#mmtId').val();
					console.log("momentID: "+momentId);
	 				$.ajax({
	 					url: '/blog/momentDel',
	 					method: 'post',
	 					contentType: 'application/x-www-form-urlencoded',
	 					data: {"momentId":momentId},
	 					beforeSend : function(xhr)
	 	               {   /*Îç∞Ïù¥ÌÑ∞Î•º Ï†ÑÏÜ°ÌïòÍ∏∞ Ï†ÑÏóê Ìó§ÎçîÏóê csrfÍ∞íÏùÑ ÏÑ§Ï†ïÌïúÎã§*/
	 	               xhr.setRequestHeader(header, token);
	 	               },
	 					success: function(result){
	 						console.log(result);
	 						alert("ÏÇ≠Ï†úÏôÑÎ£å");
	 						location.reload();
	 					},
	 					error: function(error){
	 						console.log(error);
	 					}
	 				});
				});
			});
			
			
			// ÌéòÏù¥ÏßÄ Ïù¥Îèô
			$(".blogList").on("click","#pageNum",function(e){
				newBlogList($(e.target).text());
			});

		
			
			
			// ÌéòÏù¥Ïßï ÎßåÎì§Í∏∞ Ïù¥Í±¥ Î≥∏Ïù∏ cssÎÇò htmlÏóê ÎßûÏ∂∞ÏÑú Ìï†Í≤É
			function makePageing(page){
				// Í∞ÄÏ†∏Ïò® Í≤∞Í≥ºÍ∞íÏù¥ 0Í∞úÎ©¥ Î¶¨ÌÑ¥
				if(page.totalRecord == 0){
					return;
				}
				// ÌéòÏù¥ÏßïÏùÑ ÎÑ£ÏùÑ div, ul ÏÉùÏÑ±
				let pagination = $("<div/>").addClass("pagination p1");
				let ul = $("<ul/>");
				// ÌéòÏù¥Ïßï ÏãúÏûëÎ∂ÄÎ∂ÑÏù¥ 1Î≥¥Îã§ ÌÅ¨Î©¥ Ïù¥Ï†ÑÏúºÎ°ú Í∞ÄÍ∏∞ Î≤ÑÌäº ÏÉùÏÑ± ex) <<
				if(page.startPage > 1){
					$(ul).append($("<li/>").html("&laquo;").css("font-size","30px").on("click",function(){newBlogList(page.startPage-page.pageSize)}));
				}
				// ÌéòÏù¥ÏßÄ ÏÉùÏÑ±  ex) 1 2 3 4 5
				for(let i = page.startPage; i <= page.endPage; i++){
					if(page.page == i){
						// ÌòÑÏû¨ÌéòÏù¥ÏßÄÏôÄ ÎßûÎäî ÌéòÏù¥ÏßÄÎäî Ï†ïÌï¥ÏßÑ cssÍ∞Ä ÏûÖÌòÄÏÑú ÏÉùÏÑ±
						$(ul).append($("<li/>").text(i).css("background-color","#2ecc71").css("border-radius","100%").css("color","#fff"));
					}else {
						$(ul).append($("<li/>").text(i).attr("id","pageNum").on("click",function(){newBlogList($(this).text());}));
					}
				}
				// ÌéòÏù¥Ïßï ÎÅùÎ∂ÄÎ∂ÑÏù¥ ÌéòÏù¥Ïßï ÎßàÏßÄÎßâÌéòÏù¥ÏßÄÎ≥¥Îã§ ÏûëÏúºÎ©¥ Îã§ÏùåÏúºÎ°ú Í∞ÄÍ∏∞ Î≤ÑÌäº ÏÉùÏÑ± ex) >>
				if(page.endPage < page.lastPage){
					$(ul).append($("<li/>").html("&raquo;").css("font-size","30px").on("click",function(){newBlogList(page.startPage+page.pageSize)}));
				}
				// ÏôÑÏÑ±Îêú ÌéòÏù¥ÏßïÏùÑ ÎÑ£Í∏∞
				pagination.append(ul);
				return pagination;
			}
			
			
			// Î∏îÎ°úÍ∑∏ Î¶¨Ïä§Ìä∏ ÎßåÎì§Í∏∞
			function makeBlogList(item){
				console.log("Ïù¥Ïïº!!!!!!!!!!!!!!!!!!!!!!!!!"+item.fileRoute);
				let makeClone = $(listClone).clone();
				$(makeClone).find(".album-content").data("writeid",item.writeId).data("scope",item.publicScope).data("userid",item.blogId).text(item.writeTitle+" "+item.subTitle);
				$(makeClone).find(".album-photos").find("input[type=hidden].thumbnail").val(item.blogWrite);
				$(makeClone).find(".album-photos").data("writeid",item.writeId).data("scope",item.publicScope).data("userid",item.blogId);
				$(makeClone).find(".album-photos").find("img").attr("src",item.fileRoute);
				$(makeClone).find(".album-action").find("i.fa-calendar-o").text(" "+item.writeDate.substr(0,10));
				$(makeClone).find(".album-action").find("i.fa-comment-o").text(" "+item.replyCnt);
				$(makeClone).find(".album-action").find("i.fa-eye").text(" "+item.cnt);
			
				return makeClone;
			}
			
			function scopeCheck(obj){
				let subTF = "[[${subCount}]]";
				let writeId = $(obj).data("writeid");
				let blogId = $(obj).data("userid");
				let scope = $(obj).data("scope");
				let id = "[[${#authentication.principal != 'anonymousUser' ? #authentication.principal.memberId:''}]]";
			
				console.log("Í≥µÍ∞úÎ≤îÏúÑ"+subTF);
				if(scope == "public" || scope =="partial" && subTF == "T" || blogId == id){  // Íµ¨ÎèÖÏó¨Î∂Ä Ï≤¥ÌÅ¨
					location.href="/blog/myblog/blogWrite?bno="+writeId+"&userId="+blogId
				}else if(scope == "private" && blogId == id){
					location.href="/blog/myblog/blogWrite?bno="+writeId+"&userId="+blogId
				}else{
					alert("ÏùºÎ∂ÄÍ≥µÍ∞ú Îêú Í∏ÄÏûÖÎãàÎã§.");
				} 
				
			}
			
			// Î∏îÎ°úÍ∑∏ Î¶¨Ïä§Ìä∏ Í∞ÄÏ†∏Ïò§Í∏∞
			function newBlogList(page){
				let data = nowData;
				data['page'] = page;
				
		        console.log(data);
		        $.ajax({
		        	url: '/blog/blogSearch',
			      method: 'GET',
			      contentType: 'application/x-www-form-urlencoded',
			      data: data,
			      success: function (result) {
					 $(".timeline-right").find(".album").detach();
					 $(".timeline-right").find(".pagination").detach();
					 $(result["blogList"]).each(function(index, item){
						$(".blogList").append(makeBlogList(item));
					 })
					 // ÌéòÏù¥Ïßï ÏÉàÎ°ú ÏÉùÏÑ±
					 $(".blogList").append(makePageing(result["newPaging"]));
			      },
			      error: function (error) {
			         console.log(error);
			         alert('Ïã§Ìå®');
			      }
		        })
			}
			
 			// ÎßàÏù¥Î∏îÎ°úÍ∑∏ Îì§Ïñ¥Ïò§ÏûêÎßàÏûê 1ÌéòÏù¥ÏßÄÎ°ú Î≥¥Ïó¨Ï£ºÍ∏∞
			newBlogList(1);
		</script>


	<script type="text/javascript">
	$('card').each(function () {
        let Image = $(this).attr('data-image');
        let header = $(this).html();
        let template = `
		<div class="card-wrap">
		  <div class="card">
		    <div class="card-bg" style="background-image: url(` + Image + `)"></div>
		    <div class="card-info">` + header + `
		      <slot name="content"></slot>
		    </div>
		  </div>
		</div>`;
		        $(this).replaceWith($(template).on('mousemove', handleMouseMove).on('mouseleave', handleMouseLeave));
		    })

    function handleMouseMove(e) {
        let mouseX = e.pageX - $(this).find('.card').offset().left - $(this).find('.card').outerWidth() / 2;
        let mouseY = e.pageY - $(this).find('.card').offset().top - $(this).find('.card').outerHeight() / 2;
        let mousePX = mouseX / $(this).find('.card').outerWidth();
        let mousePY = mouseY / $(this).find('.card').outerHeight();
        let tX = mousePX * -40;
        let tY = mousePY * -40;
        let rX = mousePX * 30;
        let rY = mousePY * -30;
        $(this).find('.card').css('transform', `rotateY(${rX}deg) rotateX(${rY}deg)`);
        $(this).find('.card-bg').css('transform', `translateX(${tX}px) translateY(${tY}px)`);
    };
    function handleMouseLeave() {
        setTimeout(() => {
            let mouseX = 0;
            let mouseY = 0;
            let mousePX = mouseX / $(this).find('.card').outerWidth();
            let mousePY = mouseY / $(this).find('.card').outerHeight();
            let tX = mousePX * -40;
            let tY = mousePY * -40;
            let rX = mousePX * 30;
            let rY = mousePY * -30;
            $(this).find('.card').css('transform', `rotateY(${rX}deg) rotateX(${rY}deg)`);
            $(this).find('.card-bg').css('transform', `translateX(${tX}px) translateY(${tY}px)`);
        }, 1500);
    }
	</script>
		<!-- JS -->
		<th:block layout:fragment="script">
			<script th:src="@{/shoptemplate/js/jquery-3.3.1.min.js}"></script>
			<script th:src="@{/shoptemplate/js/bootstrap.min.js}"></script>
			<script th:src="@{/shoptemplate/js/jquery.nice-select.min.js}"></script>
			<script th:src="@{/shoptemplate/js/jquery-ui.min.js}"></script>
			<script th:src="@{/shoptemplate/js/jquery.slicknav.js}"></script>
			<script th:src="@{/shoptemplate/js/mixitup.min.js}"></script>
			<script th:src="@{/shoptemplate/js/owl.carousel.min.js}"></script>
			<script th:src="@{/shoptemplate/js/main.js}"></script>
			<script src="https://kit.fontawesome.com/fef5f4c5da.js" crossorigin="anonymous"></script>
		</th:block>
	</div>

</body>
</html>